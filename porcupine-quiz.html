<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ヤマアラシクイズ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-500 to-purple-600 min-h-screen flex items-center justify-center p-4">

<div id="app" class="flex flex-col items-center justify-center min-h-screen font-sans">
    <!-- アプリケーションのコンテンツがここにレンダリングされます -->
</div>

<script>
    // クイズデータ (新世界と旧世界の問題を統合しました)
    const QUIZ_DATA = [
        {
            question: '旧世界ヤマアラシが主に住んでいる場所はどこでしょう？',
            answer: 'ヨーロッパやアフリカ、アジア',
            choices: ['北アメリカや南アメリカ', 'ヨーロッパやアフリカ、アジア']
        },
        {
            question: '旧世界ヤマアラシは、どこで生活することが多いかな？',
            answer: '地上',
            choices: ['地上', '木の上の枝']
        },
        {
            question: '旧世界ヤマアラシの針は、先端に「かえし」がついている？',
            answer: 'いいえ',
            choices: ['はい', 'いいえ']
        },
        {
            question: '旧世界ヤマアラシが敵から身を守るときに、後ろ向きに突進するのはなぜ？',
            answer: 'おしりの部分に、長くて鋭い針がたくさんあるから',
            choices: ['後ろ向きに歩くのが好きだから', 'おしりの部分に、長くて鋭い針がたくさんあるから']
        },
        {
            question: '旧世界ヤマアラシは、針を震わせてどんな音を出しますか？',
            answer: 'ガラガラと音を出す',
            choices: ['ピーピーと鳴く', 'ガラガラと音を出す']
        },
        {
            question: '旧世界ヤマアラシは普段、集団で生活する？',
            answer: 'いいえ、単独で生活することが多い',
            choices: ['はい、集団で生活する', 'いいえ、単独で生活することが多い']
        },
        {
            question: '旧世界ヤマアラシの針は毒を持っていますか？',
            answer: 'いいえ',
            choices: ['はい', 'いいえ']
        },
        {
            question: '旧世界ヤマアラシが主に食べるものは？',
            answer: '木の根っこや皮、植物',
            choices: ['お肉や虫', '木の根っこや皮、植物']
        },
        {
            question: '旧世界ヤマアラシは、どこに巣穴を作ることが多いかな？',
            answer: '土の中に穴を掘って巣穴を作る',
            choices: ['岩場の洞窟の中', '土の中に穴を掘って巣穴を作る']
        },
        {
            question: '新世界ヤマアラシが主に住んでいる場所はどこでしょう？',
            answer: '北アメリカや南アメリカ',
            choices: ['ヨーロッパやアフリカ、アジア', '北アメリカや南アメリカ']
        },
        {
            question: '新世界ヤマアラシは、どこで生活するのが得意かな？',
            answer: '木の上の枝',
            choices: ['水の中', '木の上の枝']
        },
        {
            question: '新世界ヤマアラシの針には、ある特別なヒミツが隠されています。それは何でしょう？',
            answer: '針の先に「かえし」がついている',
            choices: ['針の先が光る', '針の先に「かえし」がついている']
        },
        {
            question: '新世界ヤマアラシの防衛方法は？',
            answer: '針を立てて威嚇し、刺さると抜けにくい',
            choices: ['後ろ向きに突進する', '針を立てて威嚇し、刺さると抜けにくい']
        },
        {
            question: '新世界ヤマアラシの針は、一度抜けたらもう生えてこない？',
            answer: 'いいえ、また生えてくる',
            choices: ['はい、もう生えてこない', 'いいえ、また生えてくる']
        },
        {
            question: '新世界ヤマアラシが木の皮や葉っぱを食べるのはなぜ？',
            answer: '歯が伸び続けるから、歯を削るため',
            choices: ['おなかが空いているから', '歯が伸び続けるから、歯を削るため']
        },
        {
            question: '新世界ヤマアラシが木に登るときに使うのは？',
            answer: 'しっぽ',
            choices: ['しっぽ', 'お腹']
        },
        {
            question: '新世界ヤマアラシは、他のヤマアラシと一緒に生活する？',
            answer: 'いいえ、単独で生活することが多い',
            choices: ['はい、群れで生活する', 'いいえ、単独で生活することが多い']
        },
        {
            question: '新世界ヤマアラシの目はあまり良くない？',
            answer: 'はい',
            choices: ['はい', 'いいえ']
        }
    ];

    // 状態管理変数
    let currentPage = 'top'; // 'top', 'quiz', 'result' のいずれか
    let currentQuestionIndex = 0;
    let showResult = false;
    let isCorrect = false;
    let correctAnswer = '';
    let shuffledQuizData = [];
    let correctAnswers = 0;

    // 画像ファイルのURL
    const OLD_WORLD_IMG_URL = "kyusekai.png";
    const NEW_WORLD_IMG_URL = "sinsekai.png";

    // アイコンのSVG定義
    const CheckIcon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path fillRule="evenodd" d="M19.916 3.916a.75.75 0 00-1.06 0l-1.517 1.518-7.791 7.79-3.266-3.267a.75.75 0 00-1.06 1.06l3.791 3.79a.75.75 0 001.06 0l8.291-8.291a.75.75 0 000-1.06z" clipRule="evenodd" /></svg>`;
    const TimesIcon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path fillRule="evenodd" d="M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z" clipRule="evenodd" /></svg>`;

    // 正解数に応じてレベル名を返す
    function getLevelName(count) {
        if (count >= 10) {
            return '🚀 最強ロケット針';
        } else if (count >= 7) {
            return '🌵 ギザギザ剛毛針';
        } else if (count >= 4) {
            return '🦔 ちょこっとトゲトゲ針';
        } else if (count >= 1) {
            return '👶 生えたてヒナ針';
        }
        return 'レベル 0'; // 0問正解の場合
    }

    // 回答処理
    function handleAnswer(choice) {
        const question = shuffledQuizData[currentQuestionIndex];
        isCorrect = choice === question.answer;
        showResult = true;
        correctAnswer = question.answer;
        if (isCorrect) {
            correctAnswers++;
        }
        renderApp();
    }

    // 次の問題へ、または結果画面へ
    function handleNext() {
        showResult = false;
        currentQuestionIndex++;
        
        if (currentQuestionIndex >= shuffledQuizData.length) {
            currentPage = 'result';
        }
        renderApp();
    }

    // クイズを最初からやり直す
    function handleStartQuiz() {
        currentPage = 'quiz';
        showResult = false;
        currentQuestionIndex = 0;
        shuffledQuizData = [...QUIZ_DATA].sort(() => 0.5 - Math.random()).slice(0, 10);
        correctAnswers = 0;
        renderApp();
    }

    // UIレンダリング関数
    function renderApp() {
        const app = document.getElementById('app');
        
        let contentHTML;
        
        if (currentPage === 'top') {
            // トップページ
            contentHTML = `
                <div class="w-full max-w-lg text-center p-8 bg-white rounded-xl shadow-2xl animate-fade-in">
                    <div class="flex items-center justify-center space-x-4 mb-4">
                        <h1 class="text-4xl font-black text-indigo-700">ヤマアラシクイズ！</h1>
                    </div>
                    <p class="text-lg text-gray-700 mb-6">
                        やっほー！ぼく、ヤマアラシのハリマルだよ。<br>
                        きみは、世界に2種類のヤマアラシがいるって知ってた？
                    </p>

                    <!-- スマホでは縦並び、PCでは横並びになるように修正 -->
                    <div class="flex flex-col md:flex-row md:justify-center md:space-x-6 space-y-6 md:space-y-0 mb-8">
                        <!-- 旧世界ヤマアラシ -->
                        <div class="flex flex-col items-center bg-gray-100 p-4 rounded-lg shadow w-full md:w-1/2">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">旧世界ヤマアラシ</h3>
                            <img src="${OLD_WORLD_IMG_URL}" alt="旧世界ヤマアラシのイラスト" class="rounded-lg mb-2">
                            <ul class="text-sm text-gray-700 text-left list-disc list-inside">
                                <li>ヨーロッパ、アフリカ、アジアに住んでいるよ。</li>
                                <li>主に地面の上で生活しているんだ。</li>
                                <li>針は長くて、とがっているけど「かえし」はないよ。</li>
                            </ul>
                        </div>
                        
                        <!-- 新世界ヤマアラシ -->
                        <div class="flex flex-col items-center bg-gray-100 p-4 rounded-lg shadow w-full md:w-1/2">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">新世界ヤマアラシ</h3>
                            <img src="${NEW_WORLD_IMG_URL}" alt="新世界ヤマアラシのイラスト" class="rounded-lg mb-2">
                            <ul class="text-sm text-gray-700 text-left list-disc list-inside">
                                <li>北アメリカや南アメリカに住んでいるよ。</li>
                                <li>木の上が得意で、しっぽを使って木登りするんだ。</li>
                                <li>針は短く、「かえし」がついていて抜けにくいよ。</li>
                            </ul>
                        </div>
                    </div>

                    <p class="text-xl font-bold text-gray-800 mb-8">
                        クイズに正解して、最強の「ロケット針」レベルを目指そう！
                    </p>
                    <button
                        onclick="handleStartQuiz()"
                        class="w-full bg-purple-500 text-white font-bold text-xl py-4 px-6 rounded-full shadow-lg transition duration-300 transform hover:scale-105"
                    >
                        クイズスタート！
                    </button>
                </div>
            `;
        } else if (currentPage === 'quiz') {
            // クイズ画面
            const currentQuestion = shuffledQuizData[currentQuestionIndex];
            
            let resultHTML = '';
            if (showResult) {
                const resultText = isCorrect ? '正解！' : '残念...';
                const resultColor = isCorrect ? 'text-green-600' : 'text-red-600';
                const iconSVG = isCorrect ? CheckIcon : TimesIcon;
                
                const nextButtonText = (currentQuestionIndex === shuffledQuizData.length - 1) ? '結果を見る' : '次へ';
                
                resultHTML = `
                    <div class="mt-8 text-center p-6 bg-white bg-opacity-90 rounded-xl shadow-lg animate-fade-in">
                        <div class="flex items-center justify-center text-4xl font-bold mb-4 ${resultColor}">
                            ${iconSVG}
                            <span>${resultText}</span>
                        </div>
                        ${!isCorrect ? `
                            <p class="text-md text-gray-700 mb-4">
                                正解は <span class="font-bold text-lg text-indigo-700">『${correctAnswer}』</span> です。
                            </p>
                        ` : ''}
                        <button
                            onclick="handleNext()"
                            class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-md transition"
                        >
                            ${nextButtonText}
                        </button>
                    </div>
                `;
            }

            contentHTML = `
                <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-8 transform transition-transform duration-500 ease-in-out">
                    <div class="text-center mb-6">
                        <div class="text-sm text-gray-500 mb-1">第${currentQuestionIndex + 1}問</div>
                        <div class="text-2xl font-extrabold text-indigo-700">${currentQuestion.question}</div>
                    </div>

                    <div class="space-y-4">
                        ${currentQuestion.choices.map((choice) => `
                            <button
                                onclick="handleAnswer('${choice}')"
                                class="w-full text-lg font-semibold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105
                                ${showResult 
                                    ? (choice === currentQuestion.answer ? 'bg-green-500 text-white' : 'bg-red-400 text-white cursor-not-allowed')
                                    : 'bg-indigo-100 text-indigo-800 hover:bg-indigo-200'
                                }"
                                ${showResult ? 'disabled' : ''}
                            >
                                ${choice}
                            </button>
                        `).join('')}
                    </div>
                </div>
                ${resultHTML}
                <!-- 「最初に戻る」ボタンのスタイルを調整 -->
                <button
                    onclick="currentPage='top'; renderApp()"
                    class="mt-8 py-2 px-6 bg-transparent text-white font-medium rounded-full border border-white transition hover:bg-white hover:text-indigo-600"
                >
                    最初に戻る
                </button>
            `;
        } else if (currentPage === 'result') {
            // 結果画面
            const totalQuestions = shuffledQuizData.length;
            const correctRate = ((correctAnswers / totalQuestions) * 100).toFixed(1);
            const finalLevel = getLevelName(correctAnswers);

            contentHTML = `
                <div class="w-full max-w-lg text-center p-8 bg-white rounded-xl shadow-2xl animate-fade-in">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">クイズ終了！</h2>
                    <div class="mb-6 text-left">
                        <p class="text-lg font-medium text-gray-700">総問題数: <span class="text-indigo-600 font-bold">${totalQuestions}</span> 問</p>
                        <p class="text-lg font-medium text-gray-700">正解数: <span class="text-green-600 font-bold">${correctAnswers}</span> 問</p>
                        <p class="text-lg font-medium text-gray-700">正答率: <span class="text-blue-600 font-bold">${correctRate}%</span></p>
                    </div>
                    <div class="p-4 bg-yellow-100 rounded-lg shadow-inner mb-8">
                        <p class="text-xl font-extrabold text-yellow-800">キミのレベルは...</p>
                        <p class="text-4xl font-black text-yellow-600 mt-2">${finalLevel}</p>
                    </div>
                    <button
                        onclick="handleStartQuiz()"
                        class="w-full bg-indigo-500 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 transform hover:scale-105"
                    >
                        もう一度挑戦！
                    </button>
                </div>
            `;
        }
        app.innerHTML = contentHTML;
    }

    // アプリケーションを初期化
    window.onload = () => {
        renderApp();
    };
</script>

</body>
</html>
